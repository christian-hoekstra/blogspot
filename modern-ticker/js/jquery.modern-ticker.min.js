// Modern News Ticker | Copyright (c) CreativeTier | contact@CreativeTier.com
!function(a){var b={effect:"scroll",linksEnabled:!0,pauseOnHover:!0,autoplay:!0,feedType:"none",feedCount:5,linkTarget:"_blank",refresh:"10:00"},c={scroll:{scrollType:"continuous",scrollStart:"inside",scrollInterval:20,transitionTime:500},fade:{displayTime:4e3,transitionTime:300},type:{typeInterval:10,displayTime:4e3,transitionTime:300},slide:{slideDistance:100,displayTime:4e3,transitionTime:350}},d={rss:{feedUrl:"",loadType:"direct",processService:"YQL",forceNoCache:!1},"rss-atom":{feedUrl:"",loadType:"direct",processService:"YQL",forceNoCache:!1},twitter:{twitterName:"",twitterLoadingFile:"modern-ticker/php/twitter.php"}},e={init:function(e){var f=a.extend({},b,e);return a.extend(f,{feedType:e.feedType}),a.extend(f,d[f.feedType]),a.extend(f,{effect:e.effect}),a.extend(f,c[f.effect]),a.extend(f,e),this.each(function(){function y(){var a=n.width();o.length&&(a-=o.outerWidth(!0)),s.length&&(a-=s.outerWidth(!0)),p.css("width",a),c=a}function z(){b=0,q.children().each(function(){b+=a(this).outerWidth(!0)+1}),q.css("width",b)}function A(){switch(K(),q.addClass("mt-hide"),p.addClass("mt-preloader"),q.children().remove(),q.css("margin-left",0),r.css("opacity","1").removeClass("mt-hide"),q.append(r),f.feedType){case"rss":case"rss-atom":var b=f.feedUrl;if(f.forceNoCache&&(b+=b.indexOf("?")===-1?"?":"&",b+=Math.random().toString()),"process"===f.loadType){0===f.feedCount?-1:f.feedCount;"rss2json"!==f.processService&&(b=encodeURIComponent(b)),"rss2json"===f.processService?a.ajax({url:"http://api.rss2json.com/v1/api.json",type:"GET",dataType:"json",data:{rss_url:b},success:function(b){if("ok"===b.status){var d,c=b.items;d=0===f.feedCount||c.length<=f.feedCount?c.length:f.feedCount;for(var e=0;e<d;e++){var g;g=f.linksEnabled?"<li><a href='"+c[e].link+"' target='"+f.linkTarget+"'>"+c[e].title+"</a></li>":"<li><a>"+c[e].title+"</a></li>",q.append(g)}B()}else a.error(b.message)}}):a.ajax({url:"https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20rss%20where%20url%3D'"+b+"'&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=",type:"GET",dataType:"json",success:function(a){if(a.query){var c,b=a.query.results.item;c=0==f.feedCount||b.length<=f.feedCount?b.length:f.feedCount;for(var d=0;d<c;d++){var e;e=f.linksEnabled?"<li><a href='"+b[d].link+"' target='"+f.linkTarget+"'>"+b[d].title+"</a></li>":"<li><a>"+b[d].title+"</a></li>",q.append(e)}B()}}})}else a.ajax({url:b,type:"GET",dataType:"xml",success:function(b){var d,c=a(b).find("item");d=0==f.feedCount||c.length<=f.feedCount?c.length:f.feedCount;for(var e=0;e<d;e++){var g;g=f.linksEnabled?"<li><a href='"+a(c[e]).find("link").text()+"' target='"+f.linkTarget+"'>"+a(c[e]).find("title").text()+"</a></li>":"<li><a>"+a(c[e]).find("title").text()+"</a></li>",q.append(g)}B()}});break;case"twitter":a.get(f.twitterLoadingFile,{name:f.twitterName,count:f.feedCount},function(b){b=a.parseJSON(b);for(var c=0;c<b.length;c++){var d;d=f.linksEnabled?"<li><a href='http://twitter.com/#!/"+b[c].user.id_str+"/status/"+b[c].id_str+"' target='"+f.linkTarget+"'>"+b[c].text+"</a></li>":"<li><a>"+b[c].text+"</a></li>",q.append(d)}B()});break;case"json":a.ajax({url:f.feedUrl,type:"GET",dataType:"json",success:function(b){if("ok"===b.status){var d,c=b.items;d=0===f.feedCount||c.length<=f.feedCount?c.length:f.feedCount;for(var e=0;e<d;e++){var g;g=f.linksEnabled?"<li><a href='"+c[e].link+"' target='"+f.linkTarget+"'>"+c[e].title+"</a></li>":"<li><a>"+c[e].title+"</a></li>",q.append(g)}B()}else a.error(b.message)}})}}function B(){p.removeClass("mt-preloader"),q.removeClass("mt-hide"),D()}function C(){"rss"!=f.feedType&&"rss-atom"!=f.feedType&&"twitter"!=f.feedType&&"json"!=f.feedType||(clearTimeout(l),k=!1,A())}function D(){z(),"scroll"!=f.effect&&q.children("li:not(:first)").addClass("mt-hide"),j?(j=!1,f.autoplay&&(I(),s.length&&O())):L(),G("first"),f.refresh&&(l=setTimeout(C,E(f.refresh))),k=!0}function E(a){var b;if("number"==typeof a)b=a;else{var c=a.split(":");c.reverse(),b=parseFloat(c[0]),c[1]&&(b+=60*parseFloat(c[1])),c[2]&&(b+=3600*parseFloat(c[2]))}return 1e3*b}function F(a){k&&G(a.data.type)}function G(d){if(!h)switch(h=!0,K(),d){case"first":switch(f.effect){case"scroll":"outside"==f.scrollStart&&q.css("margin-left",c),L();break;case"fade":q.children(":first").css({opacity:0}).animate({opacity:1},f.transitionTime,function(){L()});break;case"type":M(q.children(":first").css({opacity:0}).animate({opacity:1},f.transitionTime).children("a"));break;case"slide":q.children(":first").css({opacity:0,"margin-left":f.slideDistance}).animate({opacity:1,"margin-left":0},f.transitionTime,function(){L()})}h=!1;break;case"prev":switch(f.effect){case"scroll":if("discontinuous"==f.scrollType){var i,e=H(),g=w.length-1;e==-1||0==e?q.animate({"margin-left":c},f.transitionTime,function(){q.css("margin-left",-b),q.animate({"margin-left":-w[g]},f.transitionTime,function(){h=!1})}):(i=-w[e-1],q.animate({"margin-left":i},f.transitionTime,function(){h=!1}))}else q.css({"margin-left":-a(q.children(":last")).outerWidth()}).children(":last").prependTo(q),q.animate({"margin-left":0},f.transitionTime,function(){h=!1});s.length&&t.mouseleave(function(){L()});break;case"fade":q.children(":first").animate({opacity:0},f.transitionTime,function(){a(this).addClass("mt-hide"),q.children(":last").prependTo(q).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},f.transitionTime,function(){L()}),h=!1});break;case"type":q.children(":first").animate({opacity:0},f.transitionTime,function(){a(this).addClass("mt-hide"),M(q.children(":last").prependTo(q).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},f.transitionTime).children("a")),h=!1});break;case"slide":q.children(":first").animate({opacity:0},f.transitionTime,function(){a(this).addClass("mt-hide"),q.children(":last").prependTo(q).removeClass("mt-hide").css({opacity:0,"margin-left":f.slideDistance}).animate({opacity:1,"margin-left":0},f.transitionTime,function(){L()}),h=!1})}break;case"next":switch(f.effect){case"scroll":if("discontinuous"==f.scrollType){var i,e=H(),g=w.length-1;e==g?q.animate({"margin-left":-b},f.transitionTime,function(){q.css("margin-left",c),q.animate({"margin-left":0},f.transitionTime,function(){h=!1})}):(i=e==-1?0:-w[e+1],q.animate({"margin-left":i},f.transitionTime,function(){h=!1}))}else q.animate({"margin-left":-a(q.children(":first")).outerWidth()},f.transitionTime,function(){q.css("margin-left",0).children(":first").appendTo(q),h=!1});s.length&&u.mouseleave(function(){L()});break;case"fade":q.children(":first").animate({opacity:0},f.transitionTime,function(){a(this).addClass("mt-hide").appendTo(q),q.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},f.transitionTime,function(){L()}),h=!1});break;case"type":q.children(":first").animate({opacity:0},f.transitionTime,function(){a(this).addClass("mt-hide").appendTo(q),M(q.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},f.transitionTime).children("a")),h=!1});break;case"slide":q.children(":first").animate({opacity:0},f.transitionTime,function(){a(this).addClass("mt-hide").appendTo(q),q.children(":first").removeClass("mt-hide").css({opacity:0,"margin-left":f.slideDistance}).animate({opacity:1,"margin-left":0},f.transitionTime,function(){L()}),h=!1})}}}function H(){var a=parseFloat(q.css("margin-left")),b=w.length;if(a>0)return-1;a=Math.abs(a);for(var c=0;c<b-1;c++)if(a>=w[c]&&a<w[c+1])return c;return b-1}function I(){e=!0,d="scroll"==f.effect?setInterval(function(){if(!h){var d=parseFloat(q.css("margin-left"));q.css("margin-left",d-1),"discontinuous"==f.scrollType?d<0&&Math.abs(d)>b&&q.css("margin-left",c):d<0&&Math.abs(d)>a(q.children("li")[0]).outerWidth()&&q.css("margin-left",0).children(":first").appendTo(q)}},f.scrollInterval):setInterval(function(){G("next")},f.displayTime)}function J(){e=!1,clearInterval(d)}function K(){e&&(g=!0,J())}function L(){g&&!i&&(I(),g=!1)}function M(a){N(a);var b=a.html(),c=b.split(""),d="_",e=0;a.html(d);var g=setInterval(function(){for(var f,b=!0,h="",i=!1,j=0;b;)f=c[e++],h+=f,"<"===f&&(i=!0),">"===f&&(i=!1),i||">"===f||j++,(j||e===c.length)&&(b=!1);d=d.split("_")[0]+h,e!==c.length&&(d+="_"),a.html(d),e===c.length&&(clearInterval(g),L())},f.typeInterval);a.data("mt-type",{typing:!0,content:b,interval:g})}function N(a){var b=a.data("mt-type");b&&b.typing&&(clearInterval(b.interval),a.html(b.content),a.data("mt-type").typing=!1)}function O(){v.addClass("mt-pause")}function P(){v.removeClass("mt-pause")}function Q(){return!1}var b,c,d,l,e=!1,g=!1,h=!1,i=!1,j=!0,k=!1,m=a(this),n=m.children(".mt-body"),o=n.children(".mt-label"),p=n.children(".mt-news"),q=p.children("ul"),r=q.children("li"),s=n.children(".mt-controls"),t=s.children(".mt-prev"),u=s.children(".mt-next"),v=s.children(".mt-play");if("scroll"==f.effect&&m.addClass("mt-scroll"),o.length&&p.css("left",o.outerWidth(!0)),y(),p.css("height",m.height()-2*parseInt(n.css("margin"))),a(window).resize(y),"discontinuous"==f.scrollType){var w=[],x=0;q.children().each(function(){w.push(x),x+=a(this).outerWidth()})}f.linksEnabled||q.find("a").removeAttr("href target"),f.pauseOnHover&&p.hover(function(){k&&(K(),i=!0)},function(){k&&(i=!1,L())}),s.length&&(t.mousedown(Q).bind("click",{type:"prev"},F),u.mousedown(Q).bind("click",{type:"next"},F),v.mousedown(Q).click(function(){k&&(e?(J(),P()):(I(),O()))})),"rss"==f.feedType||"rss-atom"==f.feedType||"twitter"==f.feedType||"json"==f.feedType?A():D(),m.data("pause",K),m.data("resume",L),m.data("refresh",C)})},pause:function(){return this.each(function(){a(this).data("pause")()})},resume:function(){return this.each(function(){a(this).data("resume")()})},refresh:function(){return this.each(function(){a(this).data("refresh")()})}};a.fn.modernTicker=function(b){return e[b]?e[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.modernTicker"):e.init.apply(this,arguments)}}(jQuery);