// Modern News Ticker
// Copyright (c) CreativeTier
// contact@CreativeTier.com
!function(e){var t={effect:"scroll",linksEnabled:!0,pauseOnHover:!0,autoplay:!0,feedType:"none",feedCount:5,linkTarget:"_blank",refresh:"10:00"},i={scroll:{scrollType:"continuous",scrollStart:"inside",scrollInterval:20,transitionTime:500},fade:{displayTime:4e3,transitionTime:300},type:{typeInterval:10,displayTime:4e3,transitionTime:300},slide:{slideDistance:100,displayTime:4e3,transitionTime:350}},n={"rss-atom":{feedUrl:"",loadType:"direct",forceNoCache:!1},twitter:{twitterName:"",twitterLoadingFile:"modern-ticker/php/twitter.php"}},a={init:function(a){var r=t;return e.extend(r,{feedType:a.feedType}),e.extend(r,n[r.feedType]),e.extend(r,{effect:a.effect}),e.extend(r,i[r.effect]),e.extend(r,a),this.each(function(){function t(){var e=_.width();M.length&&(e-=M.outerWidth(!0)),U.length&&(e-=U.outerWidth(!0)),N.css("width",e),k=e}function i(){C=0,O.children().each(function(){C+=e(this).outerWidth(!0)+1}),O.css("width",C)}function n(){switch(u(),O.addClass("mt-hide"),N.addClass("mt-preloader"),O.children().remove(),O.css("margin-left",0),S.css("opacity","1").removeClass("mt-hide"),O.append(S),r.feedType){case"rss-atom":var t=r.feedUrl;if(r.forceNoCache&&(t+=-1===t.indexOf("?")?"?":"&",t+=Math.random().toString()),"process"===r.loadType){var i=0===r.feedCount?-1:r.feedCount;t=encodeURIComponent(t),e.ajax({url:"https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&num="+i+"&q="+t,type:"GET",dataType:"jsonp",success:function(e){if(null!=e.responseData){var t,i=e.responseData.feed.entries;t=0==r.feedCount||i.length<=r.feedCount?i.length:r.feedCount;for(var n=0;t>n;n++){var s;s=r.linksEnabled?"<li><a href='"+i[n].link+"' target='"+r.linkTarget+"'>"+i[n].title+"</a></li>":"<li><a>"+i[n].title+"</a></li>",O.append(s)}a()}else console.error(e.responseDetails)}})}else e.ajax({url:t,type:"GET",dataType:"xml",success:function(t){var i,n=e(t).find("item");i=0==r.feedCount||n.length<=r.feedCount?n.length:r.feedCount;for(var s=0;i>s;s++){var o;o=r.linksEnabled?"<li><a href='"+e(n[s]).find("link").text()+"' target='"+r.linkTarget+"'>"+e(n[s]).find("title").text()+"</a></li>":"<li><a>"+e(n[s]).find("title").text()+"</a></li>",O.append(o)}a()}});break;case"twitter":e.get(r.twitterLoadingFile,{name:r.twitterName,count:r.feedCount},function(t){t=e.parseJSON(t);for(var i=0;i<t.length;i++){var n;n=r.linksEnabled?"<li><a href='http://twitter.com/#!/"+t[i].user.id_str+"/status/"+t[i].id_str+"' target='"+r.linkTarget+"'>"+t[i].text+"</a></li>":"<li><a>"+t[i].text+"</a></li>",O.append(n)}a()})}}function a(){N.removeClass("mt-preloader"),O.removeClass("mt-hide"),o()}function s(){("rss-atom"==r.feedType||"twitter"==r.feedType)&&(clearTimeout(w),E=!1,n())}function o(){i(),"scroll"!=r.effect&&O.children("li:not(:first)").addClass("mt-hide"),D?(D=!1,r.autoplay&&(m(),U.length&&T())):p(),d("first"),r.refresh&&(w=setTimeout(s,l(r.refresh))),E=!0}function l(e){var t;if("number"==typeof e)t=e;else{var i=e.split(":");i.reverse(),t=parseFloat(i[0]),i[1]&&(t+=60*parseFloat(i[1])),i[2]&&(t+=3600*parseFloat(i[2]))}return 1e3*t}function c(e){E&&d(e.data.type)}function d(t){if(!j)switch(j=!0,u(),t){case"first":switch(r.effect){case"scroll":"outside"==r.scrollStart&&O.css("margin-left",k),p();break;case"fade":O.children(":first").css({opacity:0}).animate({opacity:1},r.transitionTime,function(){p()});break;case"type":y(O.children(":first").css({opacity:0}).animate({opacity:1},r.transitionTime).children("a"));break;case"slide":O.children(":first").css({opacity:0,"margin-left":r.slideDistance}).animate({opacity:1,"margin-left":0},r.transitionTime,function(){p()})}j=!1;break;case"prev":switch(r.effect){case"scroll":if("discontinuous"==r.scrollType){var i,n=f(),a=L.length-1;-1==n||0==n?O.animate({"margin-left":k},r.transitionTime,function(){O.css("margin-left",-C),O.animate({"margin-left":-L[a]},r.transitionTime,function(){j=!1})}):(i=-L[n-1],O.animate({"margin-left":i},r.transitionTime,function(){j=!1}))}else O.css({"margin-left":-e(O.children(":last")).outerWidth()}).children(":last").prependTo(O),O.animate({"margin-left":0},r.transitionTime,function(){j=!1});U.length&&A.mouseleave(function(){p()});break;case"fade":O.children(":first").animate({opacity:0},r.transitionTime,function(){e(this).addClass("mt-hide"),O.children(":last").prependTo(O).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},r.transitionTime,function(){p()}),j=!1});break;case"type":O.children(":first").animate({opacity:0},r.transitionTime,function(){e(this).addClass("mt-hide"),y(O.children(":last").prependTo(O).removeClass("mt-hide").css({opacity:0}).animate({opacity:1},r.transitionTime).children("a")),j=!1});break;case"slide":O.children(":first").animate({opacity:0},r.transitionTime,function(){e(this).addClass("mt-hide"),O.children(":last").prependTo(O).removeClass("mt-hide").css({opacity:0,"margin-left":r.slideDistance}).animate({opacity:1,"margin-left":0},r.transitionTime,function(){p()}),j=!1})}break;case"next":switch(r.effect){case"scroll":if("discontinuous"==r.scrollType){var i,n=f(),a=L.length-1;n==a?O.animate({"margin-left":-C},r.transitionTime,function(){O.css("margin-left",k),O.animate({"margin-left":0},r.transitionTime,function(){j=!1})}):(i=-1==n?0:-L[n+1],O.animate({"margin-left":i},r.transitionTime,function(){j=!1}))}else O.animate({"margin-left":-e(O.children(":first")).outerWidth()},r.transitionTime,function(){O.css("margin-left",0).children(":first").appendTo(O),j=!1});U.length&&G.mouseleave(function(){p()});break;case"fade":O.children(":first").animate({opacity:0},r.transitionTime,function(){e(this).addClass("mt-hide").appendTo(O),O.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},r.transitionTime,function(){p()}),j=!1});break;case"type":O.children(":first").animate({opacity:0},r.transitionTime,function(){e(this).addClass("mt-hide").appendTo(O),y(O.children(":first").removeClass("mt-hide").css({opacity:0}).animate({opacity:1},r.transitionTime).children("a")),j=!1});break;case"slide":O.children(":first").animate({opacity:0},r.transitionTime,function(){e(this).addClass("mt-hide").appendTo(O),O.children(":first").removeClass("mt-hide").css({opacity:0,"margin-left":r.slideDistance}).animate({opacity:1,"margin-left":0},r.transitionTime,function(){p()}),j=!1})}}}function f(){var e=parseFloat(O.css("margin-left")),t=L.length;if(e>0)return-1;e=Math.abs(e);for(var i=0;t-1>i;i++)if(e>=L[i]&&e<L[i+1])return i;return t-1}function m(){x=!0,b="scroll"==r.effect?setInterval(function(){if(!j){var t=parseFloat(O.css("margin-left"));O.css("margin-left",t-1),"discontinuous"==r.scrollType?0>t&&Math.abs(t)>C&&O.css("margin-left",k):0>t&&Math.abs(t)>e(O.children("li")[0]).outerWidth()&&O.css("margin-left",0).children(":first").appendTo(O)}},r.scrollInterval):setInterval(function(){d("next")},r.displayTime)}function h(){x=!1,clearInterval(b)}function u(){x&&(I=!0,h())}function p(){I&&!W&&(m(),I=!1)}function y(e){var t=e.html().split(""),i=0;e.html("_");var n=setInterval(function(){var a=e.html().split("_")[0]+t[i++];i!=t.length&&(a+="_"),e.html(a),i==t.length&&(clearInterval(n),p())},r.typeInterval)}function T(){H.addClass("mt-pause")}function g(){H.removeClass("mt-pause")}function v(){return!1}var C,k,b,w,x=!1,I=!1,j=!1,W=!1,D=!0,E=!1,F=e(this),_=F.children(".mt-body"),M=_.children(".mt-label"),N=_.children(".mt-news"),O=N.children("ul"),S=O.children("li"),U=_.children(".mt-controls"),A=U.children(".mt-prev"),G=U.children(".mt-next"),H=U.children(".mt-play");if("scroll"==r.effect&&F.addClass("mt-scroll"),M.length&&N.css("left",M.outerWidth(!0)),t(),N.css("height",F.height()-2*parseInt(_.css("margin"))),e(window).resize(t),"discontinuous"==r.scrollType){var L=[],Q=0;O.children().each(function(){L.push(Q),Q+=e(this).outerWidth()})}r.linksEnabled||O.find("a").removeAttr("href target"),r.pauseOnHover&&N.hover(function(){E&&(u(),W=!0)},function(){E&&(W=!1,p())}),U.length&&(A.mousedown(v).bind("click",{type:"prev"},c),G.mousedown(v).bind("click",{type:"next"},c),H.mousedown(v).click(function(){E&&(x?(h(),g()):(m(),T()))})),"rss-atom"==r.feedType||"twitter"==r.feedType?n():o(),F.data("pause",u),F.data("resume",p),F.data("refresh",s)})},pause:function(){return this.each(function(){e(this).data("pause")()})},resume:function(){return this.each(function(){e(this).data("resume")()})},refresh:function(){return this.each(function(){e(this).data("refresh")()})}};e.fn.modernTicker=function(t){return a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.modernTicker"):a.init.apply(this,arguments)}}(jQuery);